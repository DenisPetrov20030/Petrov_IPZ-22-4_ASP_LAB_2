@model List<HospitalSystem.Controllers.UserRoleViewModel>

<div class="container py-5">
	<h2 class="mb-4"><i class="bi bi-people"></i> Керування користувачами</h2>

	@if (TempData["Success"] != null)
	{
		<div class="alert alert-success alert-dismissible fade show" role="alert">
			<i class="bi bi-check-circle"></i> @TempData["Success"]
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>
	}

	@if (TempData["Message"] != null)
	{
		<div class="alert alert-info alert-dismissible fade show" role="alert">
			<i class="bi bi-info-circle"></i> @TempData["Message"]
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>
	}

	<div class="card shadow-sm">
		<div class="card-body">
			<div class="table-responsive">
				<table class="table table-hover">
					<thead>
						<tr>
							<th>Користувач</th>
							<th>Email</th>
							<th>Ролі</th>
							<th>Дії</th>
						</tr>
					</thead>
					<tbody>
						@foreach (var user in Model)
						{
							<tr>
								<td>@user.UserName</td>
								<td>@user.Email</td>
								<td>
									@foreach (var role in user.Roles.Split(", "))
									{
										<span class="badge bg-@(role == "Admin" ? "danger" : role == "Doctor" ? "primary" : "secondary") me-1">
											@role
										</span>
									}
								</td>
								<td>
									@if (!user.Roles.Contains("Admin"))
									{
										<a asp-action="PromoteToAdmin" 
										   asp-route-userId="@user.UserId" 
										   class="btn btn-sm btn-outline-danger"
										   onclick="return confirm('Призначити користувача адміністратором?')">
											<i class="bi bi-shield-check"></i> Зробити адміном
										</a>
									}
									else
									{
										<a asp-action="RemoveFromAdmin" 
										   asp-route-userId="@user.UserId" 
										   class="btn btn-sm btn-outline-warning"
										   onclick="return confirm('Зняти права адміністратора?')">
											<i class="bi bi-shield-x"></i> Зняти адміна
										</a>
									}
								</td>
							</tr>
						}
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<div class="mt-3">
		<a asp-controller="Home" asp-action="Index" class="btn btn-outline-secondary">
			<i class="bi bi-arrow-left"></i> Назад
		</a>
	</div>
</div>
